metadata:
  uuid: f2506779-38af-5f7c-9928-5efb63c2b142
  name: Ensure that the admission control plugin NamespaceLifecycle is set
    (Automated)
  profile_applicability: |
    * Level 1 - Master Node
  description: |
    Reject creating objects in a namespace that is undergoing termination.
  rationale: >
    Setting admission control policy to `NamespaceLifecycle` ensures that
    objects cannot be created in non-existent namespaces, and that namespaces
    undergoing termination are not used for creating the new objects. This is
    recommended to enforce the integrity of the namespace termination process
    and also for the availability of the newer objects.
  audit: |
    Run the following command on the master node:
    ```
    ps -ef | grep kube-apiserver
    ```
    Verify that the `--disable-admission-plugins` argument is set to a value that does not
    include `NamespaceLifecycle`.
  remediation: |
    Edit the API server pod specification file
    `/etc/kubernetes/manifests/kube-apiserver.yaml` 
    on the master node and set the `--disable-admission-plugins` parameter
    to ensure it does not include `NamespaceLifecycle`.
  impact: |
    None
  default_value: |
    By default, `NamespaceLifecycle` is set.
  references: |
    1. [https://kubernetes.io/docs/admin/kube-apiserver/](https://kubernetes.io/docs/admin/kube-apiserver/)
    2. [https://kubernetes.io/docs/admin/admission-controllers/#namespacelifecycle](https://kubernetes.io/docs/admin/admission-controllers/#namespacelifecycle)
  section: API Server
  tags:
    - CIS
    - Kubernetes
    - CIS 1.2.15
    - API Server
  benchmark:
    name: CIS Kubernetes V1.20
    version: v1.0.0
